import pandas as pd
from google.colab import files

# ğŸ“‚ Subir archivo manualmente
uploaded = files.upload()
file_name = list(uploaded.keys())[0]

# ğŸ”¹ Intentar leer CSV con delimitador automÃ¡tico
try:
    df = pd.read_csv(file_name, sep=None, engine="python")  # Detecta delimitador automÃ¡ticamente
except Exception as e:
    print(f"âŒ Error al leer CSV: {e}")

///


    import pandas as pd
from google.colab import files

# ğŸ”¹ Subir archivo manualmente
uploaded = files.upload()
file_name = list(uploaded.keys())[0]  # Obtener nombre del archivo

# ğŸ”¹ Intentar leer el archivo con distintos separadores
try:
    df = pd.read_csv(file_name, encoding="latin1", sep=";", engine="python")
except:
    df = pd.read_csv(file_name, encoding="latin1", sep=",", engine="python")

# ğŸ”¹ Mostrar las columnas originales
print("\nğŸ“Œ Columnas detectadas en el archivo CSV:", df.columns.tolist())

# ğŸ”¹ Normalizar nombres de columnas
df.columns = df.columns.str.strip().str.upper().str.replace(" ", "_")

# ğŸ”¹ Mostrar los nuevos nombres de columnas
print("\nğŸ” Columnas normalizadas:", df.columns.tolist())


////




with open(file_name, "r", encoding="latin1") as file:
    lines = file.readlines()

# Mostrar las primeras 10 lÃ­neas para analizar el problema
for i, line in enumerate(lines[:10]):
    print(f"LÃ­nea {i+1}: {line}")



/////


    file_name = "Listado_hoteles_Yopal_20250315.csv"

# Leer las primeras lÃ­neas para revisar el contenido
with open(file_name, "r", encoding="latin1") as file:
    content = file.readlines()

# Mostrar las primeras 10 lÃ­neas
for i, line in enumerate(content[:10], 1):
    print(f"LÃ­nea {i}: {line.strip()}")


///


import pandas as pd
import re

file_name = "Listado_hoteles_Yopal_20250315.csv"

# Cargar el archivo eliminando el BOM
df = pd.read_csv(file_name, encoding="utf-8-sig")

# ğŸ”¹ Verificar las columnas detectadas
print("ğŸ“Œ Columnas detectadas:", df.columns.tolist())

# ğŸ”¹ Renombrar columnas eliminando espacios
df.columns = df.columns.str.strip()

# ğŸ”¹ FunciÃ³n para limpiar coordenadas
def limpiar_coordenada(valor):
    if isinstance(valor, str):
        # Remover caracteres no numÃ©ricos excepto "." y "-"
        valor = re.sub(r"[^0-9.-]", "", valor)
        # Reemplazar comas por puntos (si hubiera)
        valor = valor.replace(",", ".")
        try:
            return float(valor)  # Convertir a nÃºmero
        except ValueError:
            return None  # Si no se puede convertir, dejar como NaN
    return valor

# ğŸ”¹ Aplicar limpieza a LATITUD y LONGITUD
df["LATITUD"] = df["LATITUD"].apply(limpiar_coordenada)
df["LONGITUD"] = df["LONGITUD"].apply(limpiar_coordenada)

# ğŸ”¹ Eliminar filas con coordenadas vacÃ­as o incorrectas
df = df.dropna(subset=["LATITUD", "LONGITUD"])

# ğŸ”¹ Guardar el archivo corregido
output_file = "Listado_hoteles_Yopal_CORREGIDO.csv"
df.to_csv(output_file, index=False, encoding="utf-8-sig")

print(f"âœ… Archivo corregido guardado como: {output_file}")

    
